"use strict";(self["webpackChunksmart_mall"]=self["webpackChunksmart_mall"]||[]).push([[446],{6710:function(t,s,a){a.r(s),a.d(s,{default:function(){return g}});a(7658);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"prodetail"},[s("van-nav-bar",{attrs:{title:"商品详情","left-arrow":""},on:{"click-left":function(s){return t.$router.go(-1)}}}),s("van-swipe",{attrs:{autoplay:3e3},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(" "+t._s(t.current+1)+"/"+t._s(t.images.length)+" ")])]},proxy:!0}])},t._l(t.images,(function(t,a){return s("van-swipe-item",{key:a},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.external_url,expression:"image.external_url"}]})])})),1),s("div",{staticClass:"details"},[s("div",{staticClass:"row1"},[s("div",{staticClass:"price"},[s("div",{staticClass:"new_price"},[t._v("￥"+t._s(t.detail.goods_price_max))]),t._v("     "),s("div",{staticClass:"old_price"},[s("s",[t._v("￥"+t._s(t.detail.line_price_max))])])]),s("div",{staticClass:"count"},[t._v("已售"+t._s(t.detail.goods_sales)+"件")])]),s("div",{staticClass:"name text-ellipsis-2"},[t._v(" "+t._s(t.detail.goods_name)+" ")]),s("div",{staticClass:"row3"},[s("div",{staticClass:"left"},[s("div",[s("van-icon",{attrs:{name:"passed"}}),t._v("七天无理由退货")],1),t._v("    "),s("div",[s("van-icon",{attrs:{name:"passed"}}),t._v("48小时发货")],1)]),s("div",{staticClass:"right"},[s("van-icon",{attrs:{name:"arrow"}})],1)])]),s("div",{staticClass:"rate"},[s("div",{staticClass:"title"},[s("div",{staticClass:"left"},[t._v("商品评价(5条)")]),s("div",{staticClass:"right",staticStyle:{color:"gray"}},[t._v(" 查看更多 "),s("van-icon",{attrs:{name:"arrow"}})],1)]),t._l(t.list,(function(a){return s("div",{key:a.comment_id,staticClass:"content"},[s("div",{staticClass:"row1"},[s("img",{attrs:{src:a.user.avatar_url||t.defaultImg,alt:""}}),s("div",{staticClass:"name"},[t._v(t._s(a.user.nick_name))]),s("div",{staticClass:"star"},[s("van-rate",{attrs:{value:a.score/2,size:12,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1)]),s("div",{staticClass:"row2"},[t._v(t._s(a.content))]),s("div",{staticClass:"row3"},[t._v(t._s(a.create_time))])])}))],2),s("div",{staticClass:"pro_img"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("van-goods-action",[s("van-goods-action-icon",{attrs:{icon:"wap-home-o",text:"首页"},on:{click:function(s){return t.$router.push("/home")}}}),s("van-goods-action-icon",{attrs:{badge:t.cartTotal,icon:"cart-o",text:"购物车"},on:{click:function(s){return t.$router.push("/cart")}}}),s("van-goods-action-button",{attrs:{color:"#FF9C19",type:"warning",text:"加入购物车"},on:{click:t.addFn}}),s("van-goods-action-button",{attrs:{color:"##F7362C",type:"danger",text:"立即购买"},on:{click:t.buyNew}})],1),s("van-action-sheet",{attrs:{title:"car"===t.mode?"加入购物车":"立即购买"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[s("div",{staticClass:"content1"},[s("div",{staticClass:"row1"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"price"},[t._v("￥"+t._s(t.detail.goods_price_max))]),s("div",{staticClass:"count"},[t._v("库存"+t._s(t.detail.stock_total))])])]),s("div",{staticClass:"row2"},[s("div",{staticClass:"left"},[t._v("数量")]),s("div",{staticClass:"right"},[s("van-stepper",{model:{value:t.num,callback:function(s){t.num=s},expression:"num"}})],1)]),t.detail.stock_total>0?s("div",{staticClass:"show_btu"},["car"==t.mode?s("van-button",{attrs:{type:"primary",block:"",round:"",color:"#FF9702"},on:{click:t.addCart}},[t._v("加入购物车")]):s("van-button",{attrs:{type:"primary",block:"",round:"",color:"#F6322B"},on:{click:t.addBuy}},[t._v("立即购买")])],1):s("van-button",{attrs:{type:"primary",block:"",round:"",color:"#E8E8E8"}},[t._v("商品已售罄")])],1)])],1)},o=[],e=(a(6743),a(8848)),n=a(1787),r=a(6945),c=a(6624),d=a(4500),l={name:"ProdetailIndex",mixins:[d.Z],data(){return{goodsid:"",num:1,mode:"",current:0,images:[],detail:{},list:[],defaultImg:r,show:!1,cartTotal:0}},async created(){this.goodsid=this.$route.params.id;const{data:{detail:t}}=await(0,n.OI)(this.goodsid);this.images=t.goods_images,this.detail=t;const{data:{list:s}}=await(0,n.xD)(this.goodsid);if(this.list=s,!this.$store.getters.token)return;const{data:{cartTotal:a}}=await(0,c._G)();this.cartTotal=a},methods:{onClickIcon(){},onClickButton(){},onChange(t){this.current=t},addFn(){this.show=!0,this.mode="car"},buyNew(){this.show=!0,this.mode="buyNew"},async addCart(){if(!this.loginConfirm())return;const t=await(0,c.S0)({goodsId:this.goodsid,goodsSkuId:this.detail.skuList[0].goods_sku_id,goodsNum:this.num});200===t.status&&((0,e.Z)(t.message),this.show=!1,this.cartTotal=t.data.cartTotal)},addBuy(){this.loginConfirm()&&this.$router.push({path:"/pay",query:{mode:"buyNow",goodsId:this.goodsid,goodsNum:this.num,goodsSkuId:this.detail.skuList[0].goods_sku_id}})}}},u=l,v=a(1001),m=(0,v.Z)(u,i,o,!1,null,"0b69caca",null),g=m.exports},1787:function(t,s,a){a.d(s,{Fs:function(){return o},OI:function(){return e},xD:function(){return n}});var i=a(4471);const o=t=>i.Z.post("/goods/list",{goodsName:t.goodsName,page:t.page}),e=t=>i.Z.post("/goods/detail",{goodsId:t}),n=t=>i.Z.post("/comment/listRows",{goodsId:t,limit:5})}}]);
//# sourceMappingURL=446.3887702b.js.map